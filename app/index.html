<!DOCTYPE html>
<meta charset="utf-8">

<style>
.Offices {
	stroke: grey;
	stroke-width: 2px;
	fill: steelblue;
}
.Cubes {
	stroke: grey;
	stroke-width: 2px;
	fill: green;
}
.Bathrooms {
	stroke: grey;
	stroke-width: 2px;
	fill: yellow;
}
.Conference {
	stroke: grey;
	stroke-width: 2px;
	fill: yellow;
}
.Elevators {
	stroke: grey;
	stroke-width: 2px;
	fill: pink;
}
.Kitchen {
	stroke: grey;
	stroke-width: 2px;
	fill: red;
}
.Labs {
	stroke: grey;
	stroke-width: 2px;
	fill: purple;
}
.topbar{
	height:50px;
	width: 100%;
}
.topbar div{
	display: inline-block;
}
.lcol{
	display: inline-block;
	height: 100%;
	padding-top: 50px;
	width: 100px;
}
.content{
	display: inline-block;
	height: 100%;
	padding-left:100px;
	width: 100px;
}

</style>

<script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>

<body>
<div class='topbar'>
	<div class='layerHint'></div>
	<div class='spaceInfo'></div>
</div>
<div class='lcol'>
	<div class='seven' title='7th floor'></div>
	<div class='eight' title='8th floor'></div>
	<div class='nine' title='9th floor'></div>
</div>
<div class='content'></div>
<script>
d3.select('.layerHint, .spaceInfo').attr('height',50)

var d;

var width = 960,
	thumbheight = 50, thumbwidth = thumbheight + 30,
	fullheight = thumbheight * 10, fullwidth = thumbwidth * 10, 
	seven, eight, nine,
	infocus,
	body = d3.select('body'),
	content = d3.select('.content'),
	lcol = d3.select('.lcol');
	
function layerHint(e){
	var group = d3.select(this),
		el = group.node(), layer;
	if(infocus)
		if(d3.select(el.ownerSVGElement).attr('floor')===infocus.attr('floor')){
			while(!layer){
				el = el.parentNode;
				layer = group.attr('id') || d3.select(el).attr('id');
			}
			d3.select('.layerHint').html( layer.replace(/_/g ,' '))
		}
}

function showInfo(e){
	var selected = d3.select(this);
	if(infocus)
		if(d3.select(selected.node().ownerSVGElement).attr('floor')===infocus.attr('floor'))
			d3.select('.spaceInfo').html( selected.attr('SNum'));
}
	
function toggleHeight(e){
	var selected = d3.select(this), parent;
	if(infocus){
		if(selected.attr('infocus')) return
		infocus
			.attr('infocus',null)
			.transition()
			.style('height',thumbheight)
			.style('width',thumbwidth)
		parent = d3.select(infocus.node().parentNode)
				.style('margin-left','0px')
				.style('position','relative')
//		d3.select('.'+infocus.attr('floor'))
//			.node().appendChild(infocus.node())
	}
	infocus = selected;
	parent = d3.select(selected.node().parentNode)
		.transition()
		.style('margin-left','200px')
		.style('position','fixed')
		.duration(200)
	setTimeout(function(){
		selected
			.attr('infocus',true)
		// content.node().appendChild(selected.node()); 
		// selected 
			.transition()
			//.style('margin-left',0)
			.style('height',fullheight)
			.style('width',fullwidth)
			.attr('infocus',true)
	}, 200)
}

d3.xml("svg/7th_Floor.svg", "image/svg+xml", function(xml) {
  var container = d3.select('.seven');
  seven = d3.select(container.node().appendChild(xml.documentElement));
  seven
	.attr('floor', container.attr('class'))
	.style('height', thumbheight)
	.style('width',thumbwidth)
	.style('display','inline-block')
	.on('click',toggleHeight)
	.selectAll('g[id]').each(
		function(){
			var group = d3.select(this);
			group.selectAll('*:not(g)')
			.on('mouseover',layerHint)
			.on('click', showInfo)
		})
});
d3.xml("svg/7th_Floor.svg", "image/svg+xml", function(xml) {
  var container = d3.select('.eight');
  eight = d3.select(container.node().appendChild(xml.documentElement));
  eight
	.attr('floor', container.attr('class'))
	.style('height', thumbheight)
	.style('width',thumbwidth)
	.style('display','inline-block')
	.on('click',toggleHeight)
	.selectAll('g[id]').each(
		function(){
			var group = d3.select(this);
			group.selectAll('*:not(g)')
			.on('mouseover',layerHint)
			.on('click', showInfo)
		})
});
d3.xml("svg/7th_Floor.svg", "image/svg+xml", function(xml) {
  var container = d3.select('.nine');
  nine = d3.select(container.node().appendChild(xml.documentElement));
  nine
	.attr('floor', container.attr('class'))
	.style('height', thumbheight)
	.style('width',thumbwidth)
	.style('display','inline-block')
	.on('click',toggleHeight)
	.selectAll('g[id]').each(
		function(){
			var group = d3.select(this);
			group.selectAll('*:not(g)')
			.on('mouseover',layerHint)
			.on('click', showInfo)
		})
});

	
</script>
</body>
</html>